%!TEX root = ../thesis.tex

\chapter{计量检验}
\section{数据清洗}
由于 2014 年以前有“刚兑神话”，企业无力负担债务时承销商、担保方或是股东会选择垫付以避免公开市场违约，因此我们选择的样本覆盖了 2014 年初至今发行的信用债发行人。考虑到我国金融机构和非金融机构之间存在很大的监管差异。金融机构特别是银行、保险等行业在出现风险时，往往由于涉及面众多，牵涉民生较广，可能会引发系统性风险，政府往往会及时采取手段控制风险，如接管安邦保险、包商银行、天安财险/人寿等金融机构。在真实的案例中，亦只有天安人寿一家有展期债券，其他保险公司和银行券商均没有违约。因此在建模过程中，我们会在数据中排除掉商业银行、保险公司、证券公司类的金融机构。

城投公司是我国一个独特的存在。截止 2022 年 2 月，我国信用债券市场中企业债、公司债、中期票据、短融、超短融以及定向工具存量 66.5 万亿，而城投债存量 13 万亿。
大多数区县级城投公司以及少数市级城投公司财务状况都很不健康：负债率居高不下，财政回款慢，公益性质大盈利能力不强。但迄今为止真正意义上的城投公司违约尚未出现。\Textcite{钟辉勇2016城投债的担保可信吗}就指出城投债可能存在隐性政府背书兜底。例如 2020 年底受永煤信用事件的冲击，投资者对违约的担忧上升、风险偏好下降，出现了“抱团”城投的现象。
2021 年 7 月银保监发 [2021]15 号文指出，各银行保险机构要严格执行地方政府融资相关政策要求，打消财政兜底幻觉，强化合规管理、尽职调查，不得以任何形式新增地方政府隐性债务。或许在将来城投公司违约将逐步正常化，但目前而言城投公司违约的影响因素尚不清晰且与其他企业区别较大，因此我们在数据中亦排除城投债。

不同评级公司的评级标准不同，划分的等级也有所不一。但大多评级都是分为 A、B、C 三档，每档中划分三个主要层次，最后辅以一个正负表示是否略高或略低于标准。在回归中我们将评级为最高 AAA 的划为一档，AA 及 A 划分为一档，BBB 以下至 B 以及 CCC 以下至 C 为一档。这么做的原因如 \ref{sec:zs} 中所述，我国评价公司评级比较扭曲，集中在 AAA 和 AA 。不同档次间违约概率差别不一定比较大，大量债券被划分为了高等级债券。为了降低评级不准确的影响，本文将评级按照上述标准分类。

最后，我们在回归中加入年份作为控制变量，以控制模型未关注到的事件冲击。

\section{计量回归分析}
清洗后 6412 家发行人符合条件，如表\ref{tab:Logitresult}所示为数据整理后 Logit 回归模型的部分结果。

\input{chap/logit_table}
微观角度，评级 B/C 的企业，相较于评级 A以上企业违约率明显增加，而 AAA 企业相较于 AA 或 A 违约率差异不大，这是和预期相符的：A 评级及以上企业违约应是预期外事件，评级较低的企业更容易违约。

国企、外企、集体企业、民营企业违约可能性依次增加亦符合预期：国企可能存在一定的政府支持\autocite{mo2021china}，而跨国企业通常资金雄厚。
2018-2019 年有过所谓的“民企违约潮”，这两年民企违约债券余额均超过1000亿元。背后原因有金融去杠杆造成的融资难，但究其本质还是由于边际上资质较差的民企在 2015 年发行公司债门槛降低后涌入债券市场，而资质较差国企在当时仍能获得满足其需要的银行贷款。

上市公司违约率较低但显著程度不高，亦启发我们通过一些资本运作尽管可以降低违约概率，但不违约终究还是需要坚实的基本面作为支撑。
违约本质上还是发行人可用的资金无法覆盖到期应付的债务，因此经营和财务指标对违约的解释力较强。主营收入的增多可以显著冲抵潜在违约的可能性，经营亏损则埋下了偿债能力不足的种子。财务指标 \(Z\) 值预警亦显著。

中观角度，房地产政策显著性很高。2020 年以来地产行业受到的冲击较大，企业融资受到约束，之前的高杠杆高周转的无序扩张的苦果使得地产债于 2021 年爆发了违约大潮，几乎所有的违约地产企业都是在 2021 年特别是后半年违约的。

宏观政策对违约显著性不高，这说明财政扩张导致“国进民退”是不成立的，而放松货币政策并非能降低违约率。财政扩张存在一定的挤出效应，但也存在一定的乘数效应，使企业收入提升进而影响违约率。放松货币政策的目的还是在于避免短时间内流动性收紧影响实体经济，而非在长期降低违约数量的发生。我国政策更多认为部分企业的违约是一种正常现象，但不希望大规模的集中违约，影响实体经济。
我国宏观政策很多是以稳为主的逆周期调节。因此大多数属逆周期的宏观政策对违约的解释力较低。
但是波动率显著，说明稳定的经济可以降低违约事件的发生，侧面显示出经济以稳为主的重要性。
\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\linewidth]{./data/渤海银行.png}
	\caption{标记处为渤海租赁预测点}
	\label{fig:bhyh}
\end{figure}

\section{机器学习验证与比较}
违约实际上并非线性的因素叠加，包含了非线性的因素，如华夏幸福违约，既存在过度扩张导致现金流承压，又存在重要股东拒绝为其扩张买单，最终资金链断裂。虽然可以通过加入交互项刻画这种“同时发生”的作用，但会发生“维度灾难”，可用数据变得稀疏。
机器学习适合于提取其中非线性因素。但违约样本是偏态分布的，违约债只占约 1\%，通过神经网络等方式的机器学习极有可能会欠拟合或过拟合，使机器判断有误。
综合考虑下决定采用决策树和随机森林两种受样本分布偏态影响较小的方式进行预测。
决策树是通过二叉树这一数据结构，通过最大化信息增益的手段训练分类器，比较直观且可解释性较强。而随机森林则是一种集成算法，即通过构建多棵决策树“投票”的“森林”训练器，对于不平衡的数据集来说，它可以平衡误差，但缺乏可解释性。

决策树训练结果可视化如图\ref{fig:decision_tree}所示，Logit 模型和两种机器学习算法模型准确率如表\ref{tab:acc}所示。

\begin{figure}[h]
	\centering
	\includegraphics[width=.9\linewidth]{./data/decision_tree.png}
	\caption{\label{fig:decision_tree}决策树}
\end{figure}

图\ref{fig:decision_tree}决策树算法的关键节点如波动率、主营收入、企业性质、\(Z\) 值等在 Logit 模型中显著，在 Logit 模型中不显著的大股东持股比例分枝后判断的概率值仅勉强超过阈值，与 Logit 模型互相印证。

\begin{table}
	\caption{\label{tab:acc}不同模型的比较}
	\centering
	\begin{tabular}{lrrrrr}
		                      & accuracy & error rate & precision & recall & f1   \\
		\hline
		全部预测不违约        & 0.99     & 0.01       & -         & 0      & -    \\
		Logistic(全样本)      & 0.99     & 0.01       & 0.86      & 0.72   & 0.78 \\
		Decision Tree(测试集) & 0.99     & 0.01       & 0.93      & 0.73   & 0.82 \\
		Random Forest(测试集) & 0.99     & 0.01       & 0.85      & 0.70   & 0.76 \\
	\end{tabular}
\end{table}

表\ref{tab:acc}中准确率 accuracy 为预测正确的概率，精确率 precision 为预测违约的样本中确实违约的概率，召回率 recall 为事实违约样本中预测正确的概率。精确率和召回率是两个不同方面的分类器评价指标，他们的调和平均 F1 > 0.5 则说明该分类器是有效的。表\ref{tab:acc}中准确率与全部预测不违约的 0.99 相同，这是由于样本分布偏态造成的。但 F1 值均高于 0.5 ，证明本文使用的三个分类器都有一定的价值。且决策树算法相对优于其他算法。
决策树优于 Logit 模型算法在于其包含了非线形因素分枝。
而随机森林可能存在一定的训练集上的过拟合，因而表现出的性能较决策树更低。
如图\ref{fig:roc}所示，ROC 曲线的含义是设定任意阈值，得到的真阳性率和假阳性率。随后不断更改阈值，得到 ROC 曲线。AUC 定义为 ROC 曲线下的阈值，AUC面积越大一般认为模型拟合越好。可以看出在训练集上随机森林模型可能存在一定的过拟合，导致 AUC 达到 0.99 ，而 Logit 模型在训练集上表现不佳。
\begin{figure}[h]
	\centering
	\includegraphics[width=.9\linewidth]{./data/roc.png}
	\caption{\label{fig:roc}ROC曲线与AUC值}
\end{figure}

\section{稳健性检验}
表 \ref{tab:Logitresult} 中作为财务指标的 \(Z\) 值显著。wind 数据库会直接提供 \(Z\) 值给投资者使用，其 \(Z\) 值的计算公式为
\begin{equation}
	\label{eq:1}
	Z=1.2X_1+1.4X_2+3.3X_3+0.6X_4+0.999X_5
\end{equation}
其中 \(X_1\)代表营运资本/总资产，\(X_2\)代表留存收益/总资产，\(X_3\)代表息税前利润/总资产：以上变量及 \(X_5\) 均可以直接获得一致的数据；\(X_4\)代表总市值/负债总计，而当企业非上市，总市值数据不可得时，则使用股东权益代替。

式 \ref{eq:1} 中的 \(X_{5}\) 包括了营业收入/总资产，和主营业务收入回归元存在一定的相关性。可能模型中主营业务收入非常显著，因而导致 \(Z\) 值显著，而非 \(Z\) 值本身带有一定的经济学逻辑。为检验此种可能性，本文将计算 \(Z\) 值的元素展开。如果该可能性成立，则有假设：

\begin{hyp}
	\label{hyp:1}
	展开 \(Z\) 值的回归结果 \(X_i\forall i\in [1,2,3,4] \) 应不显著，而仅仅是 \(X_5\) 显著。
\end{hyp}

\input{chap/robust_table}
稳健性经验的部分结果如表
\ref{tab:robust}
所示，与表 \ref{tab:Logitresult} 相比基本一致，仅 SHIBOR 利率变为显著，且\(X_1\) 至 \(X_4\) 均显著，说明 \(Z\) 值中的其他成分均具有一定的预测能力，而非只是受到主营收入的影响导致显著，假设 H\ref{hyp:1}不成立。

事实上，\(Z\) 值反应了公司的变现能力、获利能力和财务结构，因而 Altman 使用其来对企业的运行状况进行分析。
公司的变现能力高意味着短期可以依靠出售资产回笼流动资金，避免流动性危机。典型的反例是土储集中在城郊地区的提前于行业倒下的泰禾地产，暴雷之后低价甩卖资产进一步恶化财务状况引发更多违约。
避免掏空式分红，利用留存收益和持续的利润增厚资本，可以使公司获得较强的抵御风险能力。譬如丹东港，高额分红导致资金短缺，资金缺口依靠债务回补，在融资审核趋严、实控人套现离场后留给当地违约的烂摊子。
公司的债券可以看作是卖出看跌期权，公司股权价值占比相对高，意味着公司价值距离行权价越远，KMV 等模型的违约距离也就越远，公司违约可能性相对较低。当然利用股权和债权融资都是适当的，公司不可过度偏废。综上 Z 值是一个很好的预测违约的指标。
